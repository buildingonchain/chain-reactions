<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Chain Reactions - A tool for executing cross-chain transactions across Ethereum, Arbitrum, and Optimism networks">
    <title>Chain Reactions</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container" role="main">
        <header role="banner">
            <h1><span aria-label="chain emoji">‚õìÔ∏è</span> Chain Reactions <span aria-label="dynamite emoji">üß®</span></h1>
        </header>

        <main>
            <!-- Wallet Section -->
            <section class="wallet-section" aria-labelledby="wallet-title">
                <div class="card">
                    <h2 id="wallet-title">Wallet</h2>
                    <div class="input-group">
                        <label for="privateKey">Private Key</label>
                        <input type="password" 
                               id="privateKey" 
                               placeholder="Enter your private key"
                               aria-describedby="pk-help"
                               autocomplete="off">
                        <span id="pk-help" class="sr-only">Enter your private key to connect your wallet. Never share this with anyone.</span>
                    </div>
                </div>
            </section>

            <!-- Transaction Section -->
            <section class="transaction-section" aria-labelledby="tx-title">
                <div class="card">
                    <h2 id="tx-title">Transaction Details</h2>
                    <div class="input-group">
                        <label for="recipient">Recipient Address</label>
                        <input type="text" 
                               id="recipient" 
                               placeholder="0x..."
                               aria-describedby="recipient-help">
                        <span id="recipient-help" class="sr-only">Enter the Ethereum address where you want to send funds</span>
                    </div>
                    <div class="input-group">
                        <label for="amount">Amount (ETH)</label>
                        <input type="number" 
                               id="amount" 
                               value="0.005" 
                               step="0.001" 
                               min="0.001"
                               aria-describedby="amount-help">
                        <span id="amount-help" class="sr-only">Enter the amount of ETH to send, minimum 0.001</span>
                    </div>
                    <button class="btn primary" 
                            id="sendTransaction" 
                            aria-label="Send transactions to all networks">
                        Send Transactions
                    </button>
                </div>
            </section>

            <!-- Status Section -->
            <section class="status-section" aria-labelledby="status-title">
                <div class="card">
                    <h2 id="status-title">Transaction Status</h2>
                    <div class="network-status" role="region" aria-label="Network statuses">
                        <div class="fuse-line" aria-hidden="true"></div>
                        <div class="network" id="sepolia" role="status">
                            <h3>Ethereum</h3>
                            <div class="balance" aria-label="Ethereum balance">Balance: -- ETH</div>
                            <div class="status" aria-label="Ethereum status">Ready</div>
                        </div>
                        <div class="network" id="arbitrum" role="status">
                            <h3>Arbitrum</h3>
                            <div class="balance" aria-label="Arbitrum balance">Balance: -- ETH</div>
                            <div class="status" aria-label="Arbitrum status">Ready</div>
                        </div>
                        <div class="network" id="optimism" role="status">
                            <h3>Optimism</h3>
                            <div class="balance" aria-label="Optimism balance">Balance: -- ETH</div>
                            <div class="status" aria-label="Optimism status">Ready</div>
                        </div>
                    </div>
                </div>
                <div id="congratsMessage" class="card success-message" style="display: none;" role="alert">
                    <h2>Chain Reaction Complete! üî•</h2>
                    <p>Congratulations! You've successfully created a cross-chain transaction cascade!</p>
                    <div class="tx-links">
                        <p><strong>Transaction Links:</strong></p>
                        <ul id="txList">
                            <!-- Transaction links will be added here dynamically -->
                        </ul>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Add CSS for screen readers -->
    <style>
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }

        /* High contrast mode support */
        @media (forced-colors: active) {
            .btn.primary {
                background-color: ButtonText;
                color: ButtonFace;
            }
            .status {
                border: 1px solid ButtonText;
            }
        }

        /* Reduced motion preference */
        @media (prefers-reduced-motion: reduce) {
            .fuse-line::before,
            .success-message,
            .network.boom::after {
                animation: none;
                transition: none;
            }
        }

        /* Focus styles */
        *:focus {
            outline: 3px solid #4A90E2;
            outline-offset: 2px;
        }

        /* Keyboard navigation */
        *:focus-visible {
            outline: 3px solid #4A90E2;
            outline-offset: 2px;
        }
    </style>

    <!-- Load dependencies -->
    <script src="https://unpkg.com/ethers@5.7.2/dist/ethers.umd.min.js"></script>

    <!-- Load Demos SDK -->
    <script>
        // Load SDK modules in sequence
        async function loadSDK() {
            try {
                // First load core websdk
                await new Promise((resolve, reject) => {
                    const script1 = document.createElement('script');
                    script1.src = 'https://unpkg.com/@kynesyslabs/demosdk@2.0.5/lib/websdk.js';
                    script1.onload = () => {
                        console.log('WebSDK loaded');
                        resolve();
                    };
                    script1.onerror = (err) => {
                        console.error('Failed to load WebSDK:', err);
                        reject(err);
                    };
                    document.head.appendChild(script1);
                });

                // Then load xmlocalsdk for cross-chain support
                await new Promise((resolve, reject) => {
                    const script2 = document.createElement('script');
                    script2.src = 'https://unpkg.com/@kynesyslabs/demosdk@2.0.5/lib/xmlocalsdk.js';
                    script2.onload = () => {
                        console.log('XML SDK loaded');
                        resolve();
                    };
                    script2.onerror = (err) => {
                        console.error('Failed to load XML SDK:', err);
                        reject(err);
                    };
                    document.head.appendChild(script2);
                });

                // Wait for SDK to be ready
                if (!window.websdk) {
                    throw new Error('WebSDK not loaded properly');
                }

                // Initialize websdk
                window.websdk.init({
                    nodeUrl: 'https://demosnode.discus.sh'
                });
                console.log('SDK initialized successfully');

            } catch (error) {
                console.error('Failed to load SDK:', error);
                alert('Failed to load Demos SDK. Please refresh the page.');
            }
        }

        // Load SDK before app code
        loadSDK().then(() => {
            // Load app code after SDK
            const appScript = document.createElement('script');
            appScript.src = 'js/chainReactions.js';
            document.head.appendChild(appScript);

            const uiScript = document.createElement('script');
            uiScript.src = 'js/app.js';
            document.head.appendChild(uiScript);
        });
    </script>
</body>
</html> 